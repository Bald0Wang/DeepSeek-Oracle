# 紫微神算 - 产品需求文档

## 一、产品概述

### 1.1 产品名称
紫微神算

### 1.2 产品定位
基于紫微斗数与AI大模型的智能命理分析应用

### 1.3 目标用户
- 对命理学感兴趣的年轻用户
- 想了解婚姻运势的单身/已婚人群
- 传统文化爱好者

### 1.4 核心价值
- 传统紫微斗数 + 现代AI解读
- 水墨国风设计，体验优雅
- 分析结果专业、易懂

---

## 二、功能需求

### 2.1 核心功能

| 功能模块 | 描述 |
|---------|------|
| 生辰录入 | 输入出生日期、时辰、时区、性别、历法 |
| 命盘生成 | 后端计算紫微斗数命盘 |
| AI分析 | 调用大模型分析婚姻、挑战、伴侣性格 |
| 结果展示 | 水墨风格卡片展示分析内容 |
| 历史记录 | 查看过往测算结果 |

### 2.2 功能流程

```
启动页 → 首页(输入信息) → 加载页(命盘计算+AI分析) → 结果页 → 可保存/分享
```

### 2.3 页面清单

| 页面 | 功能说明 |
|-----|---------|
| 启动页 | 品牌展示，水墨动画 |
| 首页 | 生辰信息输入表单 |
| 加载页 | 等待分析，墨迹动画 |
| 结果页 | 三项分析内容展示 |
| 详情页 | 单项分析完整内容 |
| 历史页 | 历史记录列表 |
| 关于页 | APP介绍、免责声明 |

---

## 三、设计规范

### 3.1 设计风格
水墨中国风

### 3.2 配色

| 名称 | 色值 | 用途 |
|-----|------|-----|
| 宣纸白 | #F8F6F0 | 主背景 |
| 淡墨灰 | #E8E4DB | 次背景/卡片 |
| 浓墨 | #2C2C2C | 主文字 |
| 淡墨 | #6B6B6B | 次要文字 |
| 朱砂红 | #A03030 | 点缀/按钮 |

### 3.3 字体
- 标题：书法风格字体
- 正文：思源宋体

### 3.4 视觉元素
- 宣纸纹理背景
- 水墨山水/云气装饰
- 印章风格图标
- 墨迹分隔线

---

## 四、技术架构

### 4.1 整体架构

```
┌────────────────┐         ┌─────────────────────────┐
│  Flutter APP   │  HTTP   │       后端服务           │
│  (iOS/Android) │ ◄─────► │  Flask + iztro + LLM    │
└────────────────┘         └─────────────────────────┘
```

### 4.2 技术选型

| 端 | 技术 |
|---|------|
| 移动端 | Flutter 3.x |
| 后端 | Python Flask |
| 命盘计算 | iztro (Node.js) |
| AI分析 | DeepSeek API |
| 数据库 | SQLite |

### 4.3 API接口

| 接口 | 方法 | 说明 |
|-----|------|-----|
| `/api/analyze` | POST | 提交生辰，返回分析结果 |
| `/api/history` | GET | 获取历史记录 |
| `/api/result/{id}` | GET | 获取单条记录详情 |

---

## 五、数据结构

### 5.1 请求参数

```json
{
  "date": "2000-01-01 12:00",
  "timezone": 8,
  "gender": "male",
  "calendar": "solar"
}
```

### 5.2 响应结构

```json
{
  "code": 200,
  "data": {
    "id": 1,
    "text_description": "命盘描述...",
    "analysis": {
      "marriage_path": "婚姻道路分析...",
      "challenges": "困难挑战分析...",
      "partner_character": "伴侣性格分析..."
    },
    "created_at": "2026-02-06 10:00:00"
  }
}
```

---

## 六、非功能需求

| 项目 | 要求 |
|-----|------|
| 响应时间 | 分析结果 < 30秒 |
| 兼容性 | iOS 12+, Android 8+ |
| 网络 | 需联网使用 |
| 存储 | 本地缓存历史记录 |

---

## 七、开发计划

| 阶段 | 内容 |
|-----|------|
| 第一阶段 | 后端API改造、Flutter项目搭建 |
| 第二阶段 | 核心功能开发（首页、结果页） |
| 第三阶段 | UI美化、动画效果 |
| 第四阶段 | 测试、优化、上线 |

---

## 八、注意事项

1. 需添加免责声明：仅供娱乐参考
2. LLM API调用需控制成本
3. 用户隐私数据不上传云端（可选本地存储）
